summary(M4)$sigma,summary(M5)$sigma)
rse
### BA
BEF_SDB<-plot$BEF_SDB
x<-plot$BA
M1<-nls(BEF_SDB~a*x^b,start=list(a=1,b=1))
M2<-nls(BEF_SDB~a+b*log(x),start=list(a=1,b=1))
M3<-nls(BEF_SDB~a+b/x,start=list(a=1,b=1))
M4<-nls(BEF_SDB~exp(a+b/x),start=list(a=1,b=1))
# M5<-nlsLM(BEF_SDB~a+b*exp(-x*c),start=list(a=1,b=1,c=1))
## goodeness-of-fit measurement
M1_r2 <- 1-(sum({summary(M1)$residuals}^2)/sum({BEF_SDB-mean(BEF_SDB)}^2))
M2_r2 <- 1-(sum({summary(M2)$residuals}^2)/sum({BEF_SDB-mean(BEF_SDB)}^2))
M3_r2 <- 1-(sum({summary(M3)$residuals}^2)/sum({BEF_SDB-mean(BEF_SDB)}^2))
M4_r2 <- 1-(sum({summary(M4)$residuals}^2)/sum({BEF_SDB-mean(BEF_SDB)}^2))
M5_r2 <- 1-(sum({summary(M5)$residuals}^2)/sum({BEF_SDB-mean(BEF_SDB)}^2))
## show goodness-of-fit measurement
# R2
R2<-c(M1_r2,M2_r2,M3_r2,M4_r2,M5_r2)
R2
# RSE
rse<- c(summary(M1)$sigma,summary(M2)$sigma,summary(M3)$sigma,
summary(M4)$sigma,summary(M5)$sigma)
rse
### Dg
BEF_SDB<-plot$BEF_SDB
x<-plot$Dg
M1<-nls(BEF_SDB~a*x^b,start=list(a=1,b=1))
M2<-nls(BEF_SDB~a+b*log(x),start=list(a=1,b=1))
M3<-nls(BEF_SDB~a+b/x,start=list(a=1,b=1))
M4<-nls(BEF_SDB~exp(a+b/x),start=list(a=1,b=1))
# M5<-nlsLM(BEF_SDB~a+b*exp(-x*c),start=list(a=1,b=1,c=1))
## goodness-of-fit measurement
M1_r2 <- 1-(sum({summary(M1)$residuals}^2)/sum({BEF_SDB-mean(BEF_SDB)}^2))
M2_r2 <- 1-(sum({summary(M2)$residuals}^2)/sum({BEF_SDB-mean(BEF_SDB)}^2))
M3_r2 <- 1-(sum({summary(M3)$residuals}^2)/sum({BEF_SDB-mean(BEF_SDB)}^2))
M4_r2 <- 1-(sum({summary(M4)$residuals}^2)/sum({BEF_SDB-mean(BEF_SDB)}^2))
# M5_r2 <- 1-(sum({summary(M5)$residuals}^2)/sum({BEF_SDB-mean(BEF_SDB)}^2))
## show goodness-of-fit measurement
# R2
R2<-c(M1_r2,M2_r2,M3_r2,M4_r2,M5_r2)
R2
# RSE
rse<- c(summary(M1)$sigma,summary(M2)$sigma,summary(M3)$sigma,
summary(M4)$sigma,summary(M5)$sigma)
rse
### Hg
BEF_SDB<-plot$BEF_SDB
x<-plot$Hg
M1<-nls(BEF_SDB~a*x^b,start=list(a=1,b=1))
M2<-nls(BEF_SDB~a+b*log(x),start=list(a=1,b=1))
M3<-nls(BEF_SDB~a+b/x,start=list(a=1,b=1))
M4<-nls(BEF_SDB~exp(a+b/x),start=list(a=1,b=1))
# M5<-nlsLM(BEF_SDB~a+b*exp(-x*c),start=list(a=1,b=1,c=1))
## goodness-of-fit measurement
M1_r2 <- 1-(sum({summary(M1)$residuals}^2)/sum({BEF_SDB-mean(BEF_SDB)}^2))
M2_r2 <- 1-(sum({summary(M2)$residuals}^2)/sum({BEF_SDB-mean(BEF_SDB)}^2))
M3_r2 <- 1-(sum({summary(M3)$residuals}^2)/sum({BEF_SDB-mean(BEF_SDB)}^2))
M4_r2 <- 1-(sum({summary(M4)$residuals}^2)/sum({BEF_SDB-mean(BEF_SDB)}^2))
# M5_r2 <- 1-(sum({summary(M5)$residuals}^2)/sum({BEF_SDB-mean(BEF_SDB)}^2))
## show goodness-of-fit measurement
# R2
R2<-c(M1_r2,M2_r2,M3_r2,M4_r2,M5_r2)
R2
# RSE
rse<- c(summary(M1)$sigma,summary(M2)$sigma,summary(M3)$sigma,
summary(M4)$sigma,summary(M5)$sigma)
rse
### V
BEF_SDB<-plot$BEF_SDB
x<-plot$V
M1<-nls(BEF_SDB~a*x^b,start=list(a=1,b=1))
M2<-nls(BEF_SDB~a+b*log(x),start=list(a=1,b=1))
M3<-nls(BEF_SDB~a+b/x,start=list(a=1,b=1))
M4<-nls(BEF_SDB~exp(a+b/x),start=list(a=1,b=1))
#M5<-nlsLM(BEF_SDB~a+b*exp(-x*c),start=list(a=1,b=1,c=1))
## goodness-of-fit measurement
M1_r2 <- 1-(sum({summary(M1)$residuals}^2)/sum({BEF_SDB-mean(BEF_SDB)}^2))
M2_r2 <- 1-(sum({summary(M2)$residuals}^2)/sum({BEF_SDB-mean(BEF_SDB)}^2))
M3_r2 <- 1-(sum({summary(M3)$residuals}^2)/sum({BEF_SDB-mean(BEF_SDB)}^2))
M4_r2 <- 1-(sum({summary(M4)$residuals}^2)/sum({BEF_SDB-mean(BEF_SDB)}^2))
#M5_r2 <- 1-(sum({summary(M5)$residuals}^2)/sum({BEF_SDB-mean(BEF_SDB)}^2))
## show goodness-of-fit measurement
#R2
R2<-c(M1_r2,M2_r2,M3_r2,M4_r2,M5_r2)
R2
# RSE
rse<- c(summary(M1)$sigma,summary(M2)$sigma,summary(M3)$sigma,
summary(M4)$sigma,summary(M5)$sigma)
rse
#### nls models for BEF_BDB ####
### age
plot$BEF_BDB <- plot$BDB/plot$V
BEF_BDB<-plot$BEF_BDB
x<-plot$age
M1<-nls(BEF_BDB~a*x^b,start=list(a=1,b=1))
M2<-nls(BEF_BDB~a+b*log(x),start=list(a=1,b=1))
M3<-nls(BEF_BDB~a+b/x,start=list(a=1,b=1))
M4<-nls(BEF_BDB~exp(a+b/x),start=list(a=1,b=1))
M5<-nlsLM(BEF_BDB~a+b*exp(-x*c),start=list(a=1,b=1,c=1))
## goodness-of-fit measurement
M1_r2 <- 1-(sum({summary(M1)$residuals}^2)/sum({BEF_BDB-mean(BEF_BDB)}^2))
M2_r2 <- 1-(sum({summary(M2)$residuals}^2)/sum({BEF_BDB-mean(BEF_BDB)}^2))
M3_r2 <- 1-(sum({summary(M3)$residuals}^2)/sum({BEF_BDB-mean(BEF_BDB)}^2))
M4_r2 <- 1-(sum({summary(M4)$residuals}^2)/sum({BEF_BDB-mean(BEF_BDB)}^2))
M5_r2 <- 1-(sum({summary(M5)$residuals}^2)/sum({BEF_BDB-mean(BEF_BDB)}^2))
## show goodness-of-fit measurement
# R2
R2<-c(M1_r2,M2_r2,M3_r2,M4_r2,M5_r2)
R2
# RSE
rse<- c(summary(M1)$sigma,summary(M2)$sigma,summary(M3)$sigma,
summary(M4)$sigma,summary(M5)$sigma)
rse
### BA
BEF_BDB<-plot$BEF_BDB
x<-plot$BA
M1<-nls(BEF_BDB~a*x^b,start=list(a=1,b=1))
M2<-nls(BEF_BDB~a+b*log(x),start=list(a=1,b=1))
M3<-nls(BEF_BDB~a+b/x,start=list(a=1,b=1))
M4<-nls(BEF_BDB~exp(a+b/x),start=list(a=1,b=1))
#M5<-nlsLM(BEF_LDB~a+b*exp(-x*c),start=list(a=0.03,b=0.7,c=0.5))
## goodness-of-fit measurement
M1_r2 <- 1-(sum({summary(M1)$residuals}^2)/sum({BEF_BDB-mean(BEF_BDB)}^2))
M2_r2 <- 1-(sum({summary(M2)$residuals}^2)/sum({BEF_BDB-mean(BEF_BDB)}^2))
M3_r2 <- 1-(sum({summary(M3)$residuals}^2)/sum({BEF_BDB-mean(BEF_BDB)}^2))
M4_r2 <- 1-(sum({summary(M4)$residuals}^2)/sum({BEF_BDB-mean(BEF_BDB)}^2))
#M5_r2 <- 1-(sum({summary(M5)$residuals}^2)/sum({BEF_BDB-mean(BEF_BDB)}^2))
## show goodness-of-fit measurement
# R2
R2<-c(M1_r2,M2_r2,M3_r2,M4_r2,M5_r2)
R2
# RSE
rse<- c(summary(M1)$sigma,summary(M2)$sigma,summary(M3)$sigma,
summary(M4)$sigma,summary(M5)$sigma)
rse
### Dg
BEF_BDB<-plot$BEF_BDB
x<-plot$Dg
M1<-nls(BEF_BDB~a*x^b,start=list(a=1,b=1))
M2<-nls(BEF_BDB~a+b*log(x),start=list(a=1,b=1))
M3<-nls(BEF_BDB~a+b/x,start=list(a=1,b=1))
M4<-nls(BEF_BDB~exp(a+b/x),start=list(a=1,b=1))
# M5<-nlsLM(BEF_BDB~a+b*exp(-x*c),start=list(a=1,b=1,c=1))
## goodness-of-fit measurement
M1_r2 <- 1-(sum({summary(M1)$residuals}^2)/sum({BEF_BDB-mean(BEF_BDB)}^2))
M2_r2 <- 1-(sum({summary(M2)$residuals}^2)/sum({BEF_BDB-mean(BEF_BDB)}^2))
M3_r2 <- 1-(sum({summary(M3)$residuals}^2)/sum({BEF_BDB-mean(BEF_BDB)}^2))
M4_r2 <- 1-(sum({summary(M4)$residuals}^2)/sum({BEF_BDB-mean(BEF_BDB)}^2))
# M5_r2 <- 1-(sum({summary(M5)$residuals}^2)/sum({BEF_BDB-mean(BEF_BDB)}^2))
## show goodness-of-fit measurement
# R2
R2<-c(M1_r2,M2_r2,M3_r2,M4_r2,M5_r2)
R2
# RSE
rse<- c(summary(M1)$sigma,summary(M2)$sigma,summary(M3)$sigma,
summary(M4)$sigma,summary(M5)$sigma)
rse
### Hg
BEF_BDB<-plot$BEF_BDB
x<-plot$Hg
M1<-nls(BEF_BDB~a*x^b,start=list(a=1,b=1))
M2<-nls(BEF_BDB~a+b*log(x),start=list(a=1,b=1))
M3<-nls(BEF_BDB~a+b/x,start=list(a=1,b=1))
M4<-nls(BEF_BDB~exp(a+b/x),start=list(a=1,b=1))
#M5<-nlsLM(BEF_BDB~a+b*exp(-x*c),start=list(a=1,b=1,c=1))
## goodness-of-fit measurement
M1_r2 <- 1-(sum({summary(M1)$residuals}^2)/sum({BEF_BDB-mean(BEF_BDB)}^2))
M2_r2 <- 1-(sum({summary(M2)$residuals}^2)/sum({BEF_BDB-mean(BEF_BDB)}^2))
M3_r2 <- 1-(sum({summary(M3)$residuals}^2)/sum({BEF_BDB-mean(BEF_BDB)}^2))
M4_r2 <- 1-(sum({summary(M4)$residuals}^2)/sum({BEF_BDB-mean(BEF_BDB)}^2))
#M5_r2 <- 1-(sum({summary(M5)$residuals}^2)/sum({BEF_BDB-mean(BEF_BDB)}^2))
## show goodness-of-fit measurement
# R2
R2<-c(M1_r2,M2_r2,M3_r2,M4_r2,M5_r2)
R2
# RSE
rse<- c(summary(M1)$sigma,summary(M2)$sigma,summary(M3)$sigma,
summary(M4)$sigma,summary(M5)$sigma)
rse
### V
BEF_BDB<-plot$BEF_BDB
x<-plot$V
M1<-nls(BEF_BDB~a*x^b,start=list(a=1,b=1))
M2<-nls(BEF_BDB~a+b*log(x),start=list(a=1,b=1))
M3<-nls(BEF_BDB~a+b/x,start=list(a=1,b=1))
M4<-nls(BEF_BDB~exp(a+b/x),start=list(a=1,b=1))
#M5<-nlsLM(BEF_BDB~a+b*exp(-x*c),start=list(a=1,b=1,c=1))
## goodness-of-fit measurement
M1_r2 <- 1-(sum({summary(M1)$residuals}^2)/sum({BEF_BDB-mean(BEF_BDB)}^2))
M2_r2 <- 1-(sum({summary(M2)$residuals}^2)/sum({BEF_BDB-mean(BEF_BDB)}^2))
M3_r2 <- 1-(sum({summary(M3)$residuals}^2)/sum({BEF_BDB-mean(BEF_BDB)}^2))
M4_r2 <- 1-(sum({summary(M4)$residuals}^2)/sum({BEF_BDB-mean(BEF_BDB)}^2))
#M5_r2 <- 1-(sum({summary(M5)$residuals}^2)/sum({BEF_BDB-mean(BEF_BDB)}^2))
## show goodness-of-fit measurement
# R2
R2<-c(M1_r2,M2_r2,M3_r2,M4_r2,M5_r2)
R2
# RSE
rse<- c(summary(M1)$sigma,summary(M2)$sigma,summary(M3)$sigma,
summary(M4)$sigma,summary(M5)$sigma)
rse
#### nls models for BEF_LDB
### age
plot$BEF_LDB<-plot$LDB/plot$V
BEF_LDB<-plot$BEF_LDB
x<-plot$age
M1<-nls(BEF_LDB~a*x^b,start=list(a=1,b=1))
M2<-nls(BEF_LDB~a+b*log(x),start=list(a=1,b=1))
M3<-nls(BEF_LDB~a+b/x,start=list(a=1,b=1))
M4<-nls(BEF_LDB~exp(a+b/x),start=list(a=1,b=1))
M5<-nlsLM(BEF_LDB~a+b*exp(-x*c),start=list(a=1,b=1,c=1))
## goodness-of-fit measurement
M1_r2 <- 1-(sum({summary(M1)$residuals}^2)/sum({BEF_LDB-mean(BEF_LDB)}^2))
M2_r2 <- 1-(sum({summary(M2)$residuals}^2)/sum({BEF_LDB-mean(BEF_LDB)}^2))
M3_r2 <- 1-(sum({summary(M3)$residuals}^2)/sum({BEF_LDB-mean(BEF_LDB)}^2))
M4_r2 <- 1-(sum({summary(M4)$residuals}^2)/sum({BEF_LDB-mean(BEF_LDB)}^2))
M5_r2 <- 1-(sum({summary(M5)$residuals}^2)/sum({BEF_LDB-mean(BEF_LDB)}^2))
## show goodness-of-fit measuremnt
# R2
R2<-c(M1_r2,M2_r2,M3_r2,M4_r2,M5_r2)
R2
# RSE
rse<- c(summary(M1)$sigma,summary(M2)$sigma,summary(M3)$sigma,
summary(M4)$sigma,summary(M5)$sigma)
rse
### BA
BEF_LDB<-plot$BEF_LDB
x<-plot$BA
M1<-nls(BEF_LDB~a*x^b,start=list(a=1,b=1))
M2<-nls(BEF_LDB~a+b*log(x),start=list(a=1,b=1))
M3<-nls(BEF_LDB~a+b/x,start=list(a=1,b=1))
M4<-nls(BEF_LDB~exp(a+b/x),start=list(a=1,b=1))
# M5<-nlsLM(BEF_LDB~a+b*exp(-x*c),start=list(a=1,b=1,c=1))
## goodness-of-fit measurement
M1_r2 <- 1-(sum({summary(M1)$residuals}^2)/sum({BEF_LDB-mean(BEF_LDB)}^2))
M2_r2 <- 1-(sum({summary(M2)$residuals}^2)/sum({BEF_LDB-mean(BEF_LDB)}^2))
M3_r2 <- 1-(sum({summary(M3)$residuals}^2)/sum({BEF_LDB-mean(BEF_LDB)}^2))
M4_r2 <- 1-(sum({summary(M4)$residuals}^2)/sum({BEF_LDB-mean(BEF_LDB)}^2))
#M5_r2 <- 1-(sum({summary(M5)$residuals}^2)/sum({BEF_LDB-mean(BEF_LDB)}^2))
## show goodness-of-fit measurement
# R2
R2<-c(M1_r2,M2_r2,M3_r2,M4_r2,M5_r2)
R2
# RSE
rse<- c(summary(M1)$sigma,summary(M2)$sigma,summary(M3)$sigma,
summary(M4)$sigma,summary(M5)$sigma)
rse
### Dg
BEF_LDB<-plot$BEF_LDB
x<-plot$Dg
M1<-nls(BEF_LDB~a*x^b,start=list(a=1,b=1))
M2<-nls(BEF_LDB~a+b*log(x),start=list(a=1,b=1))
M3<-nls(BEF_LDB~a+b/x,start=list(a=1,b=1))
M4<-nls(BEF_LDB~exp(a+b/x),start=list(a=1,b=1))
#M5<-nls(BEF_LDB~a+b*exp(-x*c),start=list(a=1,b=1,c=1))
## goodness-of-fit measurement
M1_r2 <- 1-(sum({summary(M1)$residuals}^2)/sum({BEF_LDB-mean(BEF_LDB)}^2))
M2_r2 <- 1-(sum({summary(M2)$residuals}^2)/sum({BEF_LDB-mean(BEF_LDB)}^2))
M3_r2 <- 1-(sum({summary(M3)$residuals}^2)/sum({BEF_LDB-mean(BEF_LDB)}^2))
M4_r2 <- 1-(sum({summary(M4)$residuals}^2)/sum({BEF_LDB-mean(BEF_LDB)}^2))
# M5_r2 <- 1-(sum({summary(M5)$residuals}^2)/sum({BEF_LDB-mean(BEF_LDB)}^2))
## show goodness-of-fit measurement
# R2
R2<-c(M1_r2,M2_r2,M3_r2,M4_r2,M5_r2)
R2
# RSE
rse<- c(summary(M1)$sigma,summary(M2)$sigma,summary(M3)$sigma,
summary(M4)$sigma,summary(M5)$sigma)
rse
### Hg
BEF_LDB<-plot$BEF_LDB
x<-plot$Hg
M1<-nls(BEF_LDB~a*x^b,start=list(a=1,b=1))
M2<-nls(BEF_LDB~a+b*log(x),start=list(a=1,b=1))
M3<-nls(BEF_LDB~a+b/x,start=list(a=1,b=1))
M4<-nls(BEF_LDB~exp(a+b/x),start=list(a=1,b=1))
#M5<-nlsLM(BEF_LDB~a+b*exp(-x*c),start=list(a=1,b=1,c=1))
## goodness-of-fit measurement
M1_r2 <- 1-(sum({summary(M1)$residuals}^2)/sum({BEF_LDB-mean(BEF_LDB)}^2))
M2_r2 <- 1-(sum({summary(M2)$residuals}^2)/sum({BEF_LDB-mean(BEF_LDB)}^2))
M3_r2 <- 1-(sum({summary(M3)$residuals}^2)/sum({BEF_LDB-mean(BEF_LDB)}^2))
M4_r2 <- 1-(sum({summary(M4)$residuals}^2)/sum({BEF_LDB-mean(BEF_LDB)}^2))
# M5_r2 <- 1-(sum({summary(M5)$residuals}^2)/sum({BEF_LDB-mean(BEF_LDB)}^2))
## show goodness-of-fit measurement
# R2
R2<-c(M1_r2,M2_r2,M3_r2,M4_r2,M5_r2)
R2
# RSE
rse<- c(summary(M1)$sigma,summary(M2)$sigma,summary(M3)$sigma,
summary(M4)$sigma,summary(M5)$sigma)
rse
### V
BEF_LDB<-plot$BEF_LDB
x<-plot$V
M1<-nls(BEF_LDB~a*x^b,start=list(a=1,b=1))
M2<-nls(BEF_LDB~a+b*log(x),start=list(a=1,b=1))
M3<-nls(BEF_LDB~a+b/x,start=list(a=1,b=1))
M4<-nls(BEF_LDB~exp(a+b/x),start=list(a=1,b=1))
#M5<-nlsLM(BEF_LDB~a+b*exp(-x*c),start=list(a=1,b=1,c=1))
## goodness-of-fit measurement
M1_r2 <- 1-(sum({summary(M1)$residuals}^2)/sum({BEF_LDB-mean(BEF_LDB)}^2))
M2_r2 <- 1-(sum({summary(M2)$residuals}^2)/sum({BEF_LDB-mean(BEF_LDB)}^2))
M3_r2 <- 1-(sum({summary(M3)$residuals}^2)/sum({BEF_LDB-mean(BEF_LDB)}^2))
M4_r2 <- 1-(sum({summary(M4)$residuals}^2)/sum({BEF_LDB-mean(BEF_LDB)}^2))
#M5_r2 <- 1-(sum({summary(M5)$residuals}^2)/sum({BEF_LDB-mean(BEF_LDB)}^2))
## show goodness-of-fit measurement
# R2
R2<-c(M1_r2,M2_r2,M3_r2,M4_r2,M5_r2)
R2
# RSE
rse<- c(summary(M1)$sigma,summary(M2)$sigma,summary(M3)$sigma,
summary(M4)$sigma,summary(M5)$sigma)
rse
#### Seemingly Unrelated Regression - SUR for BEF
Ms.formula<- BEF_SDB~b0*Hg^b1
Mb.formula<- BEF_BDB~b2*Hg^b3
Ml.formula<- BEF_LDB~exp(b4+b5/Dg)
equations <- list(Ms.formula,Mb.formula,Ml.formula)
start.values <- c(b0=0.99532  ,b1=-0.26835  ,b2=0.119390
,b3=-0.338020,b4=-4.351000,b5=150.518260)
labels <- list("BEF_SDB","BEF_BDB","BEF_LDB")
SUR<-nlsystemfit(method ="SUR",equations,start.values,data=plot,eqnlabels=labels)
print(SUR)
summary(SUR)
SUR$eq[3]
SUR$resids
SUR$nlmest
# R2 for SDB estimation
Mssrr2
# R2 for BDB estimation
Mbsrr2
# R2 for LDB estimation
Mlsrr2
# best model (9) for SDB estimation
summary(Ms9)
# best model (9) for BDB estimation
summary(Mb9)
# best model (5) for LDB estimation
summary(Ml5)
#### visualization of model residuals and model fitting
# load prediction result
ADB_predicted <- read_excel("data/ADB_predicted.xlsx")
# residuals plot
p10 <- ggplot(data = ADB_predicted, aes(ADB_predicted$pridicted, ADB_predicted$residuals))+
geom_point()+theme_bw()+labs(title = "(a)", x="Predicted ADB (kg)", y="Residuals")
## ADB measured and predicted plot
# load prediction and reference data
ADB_compare <- read_excel("data/ADB_compare.xlsx")
p11 <- ggplot(data = ADB_compare, aes(ADB_compare$Measured,ADB_compare$predicted))+
geom_point()+labs(title = "(b)",x="Observed ADB (kg)", y="Predicted ADB (kg)")+
geom_smooth(method='lm',se = FALSE, color="black")+
# stat_poly_eq(formula = y ~ x,
#              aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
#              parse = TRUE)+
theme_bw()
grid.arrange(p10,p11,ncol=2, top='Figure 3. Distribution of residuals for analyzed aboveground biomass models (a) \n and the relationship between predicted and observed aboveground biomass (ADB).\n')
#### visualization of relationships between biomass component ~ stand characteristics
### SDB ~ stand characteristics
p16 <- ggplot(data = plot, aes(BEF_SDB,age))+
geom_point()+ labs(title = "SDB",x="",y="")+
geom_smooth(method = "lm",se = FALSE, color = "black")+
theme_bw()+
theme(plot.title = element_text(hjust = 0.5))+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
p17 <- ggplot(data = plot, aes(BEF_SDB,BA))+
geom_point()+ labs(x="",y="")+
geom_smooth(method = "lm",se = FALSE, color = "black")+
theme_bw()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
p18 <- ggplot(data = plot, aes(BEF_SDB,Dg))+
geom_point()+ labs(x="",y="")+
geom_smooth(method = "lm",se = FALSE, color = "black")+
theme_bw()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
p19 <- ggplot(data = plot, aes(BEF_SDB, Hg))+
geom_point()+ labs(x="",y="")+
geom_smooth(method = "lm",se = FALSE, color = "black")+
theme_bw()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
p20 <- ggplot(data = plot, aes(BEF_SDB, V))+
geom_point()+ labs(x="",y="")+
geom_smooth(method = "lm",se = FALSE, color = "black")+
theme_bw()
### BDB ~ stand characteristics
p21 <- ggplot(data = plot, aes(BEF_BDB,age))+
geom_point()+ labs(title = "BDB",x="",y="")+
geom_smooth(method = "lm",se = FALSE, color = "black")+
theme_bw()+
theme(plot.title = element_text(hjust = 0.5))+
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),)
p22 <- ggplot(data = plot, aes(BEF_BDB,BA))+
geom_point()+ labs(x="",y="")+
geom_smooth(method = "lm",se = FALSE, color = "black")+
theme_bw()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(),)
p23 <- ggplot(data = plot, aes(BEF_BDB,Dg))+
geom_point()+ labs(x="",y="")+
geom_smooth(method = "lm",se = FALSE, color = "black")+
theme_bw()+
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
p24 <- ggplot(data = plot, aes(BEF_BDB, Hg))+
geom_point()+ labs(x="",y="")+
geom_smooth(method = "lm",se = FALSE, color = "black")+
theme_bw()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())
p25 <- ggplot(data = plot, aes(BEF_BDB, V))+
geom_point()+ labs(x="",y="")+
geom_smooth(method = "lm",se = FALSE, color = "black")+
theme_bw()+
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank())
### LDB ~ stand characteristics
p26 <- ggplot(data = plot, aes(BEF_LDB,age))+
geom_point()+ labs(title = "LDB",x="",y="Age")+
geom_smooth(method = "lm",se = FALSE, color = "black")+
theme_bw()+
theme(plot.title = element_text(hjust = 0.5))+
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())+
scale_y_continuous(position = "right")
p27 <- ggplot(data = plot, aes(BEF_LDB,BA))+
geom_point()+ labs(x="",y="BA")+
geom_smooth(method = "lm",se = FALSE, color = "black")+
theme_bw()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())+
scale_y_continuous(position = "right")
p28 <- ggplot(data = plot, aes(BEF_LDB,Dg))+
geom_point()+ labs(x="",y="Dg")+
geom_smooth(method = "lm",se = FALSE, color = "black")+
theme_bw()+
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())+
scale_y_continuous(position = "right")
p29 <- ggplot(data = plot, aes(BEF_LDB, Hg))+
geom_point()+ labs(x="",y="Hg")+
geom_smooth(method = "lm",se = FALSE, color = "black")+
theme_bw()+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank())+
scale_y_continuous(position = "right")
p30 <- ggplot(data = plot, aes(BEF_LDB, V))+
geom_point()+ labs(x="",y="V")+
geom_smooth(method = "lm",se = FALSE, color = "black")+
theme_bw()+
theme(axis.text.y=element_blank(),
axis.ticks.y=element_blank())+
scale_y_continuous(position = "right")
grid.arrange(p16,p21,p26,p17,p22,p27,p18,p23,p28,p19,p24,p29,p20,p25,p30,
ncol=3, left = textGrob("BEF",rot = 90, gp=gpar(fontsize=16)),
top=textGrob('Figure 4. Relationships between tree stand characteristics and BCEFs \n for biomass components:  branches (BDB), foliage (LDB), and stem (SDB). \n',gp=gpar(fontsize=16)))
# load data
BEF_predicted <- read_excel("data/BEF_predicted.xlsx")
# residuals plot
p31 <- ggplot(data = BEF_predicted, aes(BEF_predicted$SDB_pre, BEF_predicted$SDB_re))+
geom_point()+theme_bw()+labs(title = "SDB", x="Predicted BEF", y="Residuals")+
theme(plot.title = element_text(hjust = 0.5))
p32 <- ggplot(data = BEF_predicted, aes(BEF_predicted$BDB_pre, BEF_predicted$BDB_re))+
geom_point()+theme_bw()+labs(title = "BDB", x="Predicted BEF", y="Residuals")+
theme(plot.title = element_text(hjust = 0.5))
p33 <- ggplot(data = BEF_predicted, aes(BEF_predicted$LDB_pre, BEF_predicted$LDB_re))+
geom_point()+theme_bw()+labs(title = "LDB", x="Predicted BEF", y="Residuals")+
theme(plot.title = element_text(hjust = 0.5))
p34 <- ggplot(data = BEF_predicted, aes(BEF_predicted$ADB_pre, BEF_predicted$ADB_re))+
geom_point()+theme_bw()+labs(title = "ADB", x="Predicted BEF", y="Residuals")+
theme(plot.title = element_text(hjust = 0.5))
grid.arrange(p31,p32,p33,p34,ncol=2, top=textGrob('Figure 5. Distribution of residuals for analyzed BCEFs of biomass components.\n', gp=gpar(fontsize=16)))
# ADB measured and predicted plot
BEF_ADB_compare <- read_excel("data/BEF_ADB_compare.xlsx")
ggplot(data = BEF_ADB_compare, aes(ADB,ADB_predicted))+
geom_point()+labs(x="Observed ADB (kg)", y="Predicted ADB (kg)")+
geom_smooth(method='lm',se = FALSE, color="black")+
theme_bw()+
labs(title = 'Figure 6. Relationship between predicted and observed ADB (kg) \n using calculated BCEFs.\n')
# stat_poly_eq(formula = y ~ x,
#              aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
#              parse = TRUE)+
data_tree
data_plot
